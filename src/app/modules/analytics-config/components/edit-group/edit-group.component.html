<div class="group-wrapper" [formGroup]="formGroup">
    <div class="edit-group">
        <div class="edit-group-form">
            <div class="fields">
                <div>
                    <mat-form-field class="icon">
                        <mat-label>{{'Icon' | translate}}</mat-label>
                        <mat-icon matPrefix>{{this.formGroup.controls.icon.value}}</mat-icon>
                        <input matInput formControlName="icon" [iconPicker]="this.formGroup.controls.icon.value"
                            [ipIconPack]="['mat']" [ipFallbackIcon]="'poll'" [ipPosition]="'left'" 
                            [ipButtonStyleClass]="'mat-raised-button'"
                            (iconPickerSelect)="onIconPickerSelect($event)" />
                    </mat-form-field>
                </div>
                <div>
                    <mat-form-field>
                        <mat-label>{{'Title' | translate}}</mat-label>
                        <input matInput formControlName="title" (change)="updatePreview()">
                    </mat-form-field>
                </div>
                <!-- <div>
                    <mat-form-field>
                        <mat-label>Type</mat-label>
                        <mat-select formControlName="contentType"
                            appAlertOnChange="changing the type will reset the set-up widgets" appResetOnChange
                            [dependants]="[content]">
                            <mat-optgroup *ngFor="let nbWidgets of [1, 2, 3]"
                                [label]="('With ' + nbWidgets + ' widget(s)') | translate ">
                                <mat-option *ngFor="let types of getContentTypes(nbWidgets)" [value]="types">
                                    {{types.join(' / ') | translate}}
                                </mat-option>
                            </mat-optgroup>
                        </mat-select>
                    </mat-form-field>
                </div> -->
                <div>
                    <mat-error *ngIf="formGroup.controls.content.touched && formGroup.controls.content.invalid">
                        {{ contentTypeValue.length | i18nPlural:{
                            '=1': 'The widget within isn\'t valid' | translate, 
                            'other': 'The widgets within aren\'t valid' | translate
                        } }}
                    </mat-error>
                </div>
            </div>
            <div *ngIf="!contentTypeValue" class="edit-widgets">
                <button mat-raised-button (click)="addWidget()">
                    <mat-icon>add</mat-icon>
                    {{'Add a widget' | translate}}
                </button>
            </div>
            <div *ngIf="contentTypeValue" class="edit-widgets">

                <div *ngFor="let comp of contentTypeValue; index as ci;">
                    <button mat-raised-button (click)="editWidget(ci)">
                        <mat-icon>edit</mat-icon>
                        {{('Edit ' | translate) + ' ' +  comp}}
                    </button>
                </div>
            </div>
        </div>
    </div>
    <div class="preview-group" *ngIf="formGroup.value.preview.length > 0">
        <arlas-analytics-board [groups]="formGroup.value.preview" [showSpinner]="true"></arlas-analytics-board>
    </div>
    <div class="preview-placeholder" *ngIf="formGroup.value.preview.length == 0"></div>
</div>